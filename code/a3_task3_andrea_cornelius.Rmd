---
title: "Task 3 - Urchins (CORNELIUS)"
author: "Andrea Cornelius"
date: "10/21/2021"
output: html_document
---
# Overview

**Data citation**: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. (https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b) 

# Setup
```{r setup, include=TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE, options(digits = 2))
# Attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(lubridate)
```

## Read in the data
```{r}
# Read in data
urchins <- read_csv(here("data", "urchins.csv"), show_col_types = FALSE)
```

## Clean up data
```{r}
# Change column names to lower_snake_case
urchins_clean <- urchins %>%
clean_names()
```

# Section 1: Size comparisons, purple and red urchins

## i. Data visualization
```{r}
# Create histogram plotting urchin size faceted by species
ggplot(urchins_clean, aes(x = size, fill = common_name)) +
  geom_histogram(bins = 10) +
  facet_wrap(~common_name) +
  scale_fill_manual(values=c("purple","red"), 
                    name = "Common Name") +
  labs(x = "Size (cm)",
       y = "Urchin Count",
       title = "Urchin Counts by Size and Species (CORNELIUS)") +
  theme_bw()
```

**Figure # 1: Urchin count by size for both red and purple urchins.**

## ii. Descriptive statistics table
```{r}
# Make a summary table for red and purple urchins including mean, median, standard deviation, and sample size; call it out.
urchins_summary <- urchins_clean %>%
  group_by(common_name) %>%
  summarize("Mean Size (cm)" = mean(size),
            "Median Size (cm)" = median(size),
            "Size Standard Deviation (cm)" = sd(size),
            "Sample Size (cm)" = n()) %>%
  rename("Common Name" = common_name) 
  
# Finalize summary table through Kable
knitr::kable(head(urchins_summary),
             caption = "<b> Table 1: Mean, Median, and Standard Deviations for urchin radii of purple and red urchins. <b>") %>%
  kable_styling(full_width = F)
             
```

**iii. Overall Takeaways:** The red urchin is larger than the purple urchin. There is a larger spread for the red urchins than the purple (almost 2 standard deviations instead of 1). Actual difference in mean size (urchin diameter (cm)) is 2.3 cm, whereas difference in percentage is 1.5%.

# Section 2. Explore purple urchin counts by site and year

## i. Data wrangling


```{r} 
date <- as.Date("2008-10-10") # Classify date

date

class(date) # Check the class

# Is this chunk really necessary?
```

```{r} 
# Create stored subset of urchins data:
purple_urchins <- urchins_clean %>% # Pull from clean urchins data
  filter(common_name == "Purple Urchin") %>% # Filter by purple urchin
  mutate(date_new = mdy(date)) %>% # Convert class to date
  mutate(year_new = year(date_new)) %>% # Convert new column that only contains year
mutate(site_full = case_when( # Add a new column with full site names
    site == "NAPL" ~ "Naples Reef",
    site == "AQUE" ~ "Arroyo Quemado Reef", 
    site == "CARP" ~ "Carpinteria Reef", 
    site == "MOHK" ~ "Mohawk Reef", 
    site == "IVEE" ~ "Isla Vista Reef"))
```


```{r}
# Make a table containing total number of purple urchins observed by site and year
purple_urchins_summary <- purple_urchins %>%
  group_by(site, year_new) %>%
  summarize(count = n())

purple_urchins_summary
```

