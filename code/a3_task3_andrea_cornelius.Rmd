---
title: "Task 3 - Urchins (CORNELIUS)"
author: "Andrea Cornelius"
date: "10/21/2021"
output: html_document
---
# Overview

**Data citation**: Reed, D. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. (https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b) 

# Setup
```{r setup, include=TRUE, message = FALSE, warning = FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Attach packages
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(lubridate)
```

## Read in the data
```{r}
# Read in data
urchins <- read_csv(here("data", "urchins.csv"), show_col_types = FALSE)
```

## Clean up data
```{r}
# Change column names to lower_snake_case
urchins_clean <- urchins %>%
clean_names()
```

# Section 1: Size comparisons, purple and red urchins

## i. Data visualization
```{r}
# Create histogram plotting urchin size faceted by species
ggplot(urchins_clean, aes(x = size, fill = common_name)) +
  geom_histogram(bins = 10) +
  facet_wrap(~common_name) +
  scale_fill_manual(values=c("purple","red"), 
                    name = "Common Name") +
  labs(x = "Size (cm)",
       y = "Urchin Count",
       title = "Urchin Counts by Size and Species (CORNELIUS)") +
  theme_bw()
```

**Figure # 1: Urchin count by size for both red and purple urchins.**

## ii. Descriptive statistics table
```{r}
# Make a summary table for red and purple urchins including mean, median, standard deviation, and sample size; call it out.
urchins_summary <- urchins_clean %>%
  group_by(common_name) %>%
  summarize("Mean Size (cm)" = mean(size),
            "Median Size (cm)" = median(size),
            "Size Standard Deviation (cm)" = sd(size),
            "Sample Size (cm)" = n(),
            options(digits = 2)) %>%
  rename("Common Name" = common_name) 
  
# Return summary table
urchins_summary
```

**iii. Overall Takeaways:** The red urchin is larger than the purple urchin. There is a larger spread for the red urchins than the purple (almost 2 standard deviations instead of 1). Actual difference in mean size (urchin diameter (cm)) is 2.3 cm, whereas difference in percentage is 1.5%.

# Section 2. Explore purple urchin counts by site and year

## i. Data wrangling

```{r}
date <- as.Date("2008-10-10")

date

class(date) # Check the class
```

```{r}
as.POSIXct(x = "10/10/08",
           format = "%m%d%Y")
purple_urchins <- urchins_clean %>% # Pull from clean urchins data
  filter(common_name == "Purple Urchin") %>% # Filter by purple urchin
  mutate(date_string = paste(date, sep = "/"),
    date = lubridate::ymd(date_string)) %>%
  mutate(year_new = year(date)) %>%
mutate(site_full = case_when( # Add a new column  
    site == "NAPL" ~ "Naples Reef",
    site == "AQUE" ~ "Arroyo Quemado Reef", 
    site == "CARP" ~ "Carpinteria Reef", 
    site == "MOHK" ~ "Mohawk Reef", 
    site == "IVEE" ~ "Isla Vista Reef"))

```

